package com.example.project;

import java.util.ArrayList;
import java.util.List;

import com.baidu.mapapi.SDKInitializer;
import android.graphics.Color;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentPagerAdapter;
import android.support.v4.view.ViewPager;
import android.support.v4.view.ViewPager.OnPageChangeListener;
import android.view.Window;
import android.widget.TextView;

public class MainActivity extends FragmentActivity{

	//页面切换
	private ViewPager mViewPager;
	private FragmentPagerAdapter mPagerAdapter;
	private List<Fragment> mFragmentList;
	
	//导航栏
	private TextView mNavTextView1;
	private TextView mNavTextView2;
	private TextView mNavTextView3;
	
	//3个页卡
	MyFragment01 frag1;
	
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        
        //在使用SDK各组件之前初始化context信息，传入ApplicationContext  
        //注意该方法要再setContentView方法之前实现  
        SDKInitializer.initialize(getApplicationContext()); 
        
        //去除默认的标题栏
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.main);
        
        //初始化控件
        initView();      
    }

    //初始化控件
	private void initView() {
		//初始化页面控制器
		mViewPager = (ViewPager) findViewById(R.id.viewPager);
		
		//初始化导航栏三个标题
		mNavTextView1 = (TextView) findViewById(R.id.nav_textview1);
		mNavTextView2 = (TextView) findViewById(R.id.nav_textview2);
		mNavTextView3 = (TextView) findViewById(R.id.nav_textview3);
		
		//初始化3个tab页
		mFragmentList = new ArrayList<Fragment>();	
		frag1 = new MyFragment01();
		mFragmentList.add(frag1);
		
		final MyFragment02 frag2 = new MyFragment02();
        mFragmentList.add(frag2);
            
		final MyFragment03 frag3 = new MyFragment03();
		mFragmentList.add(frag3);
		
		//初始化页面适配器
		mPagerAdapter = new FragmentPagerAdapter(getSupportFragmentManager()) {	
			@Override
			public int getCount() {
				return mFragmentList.size();
			}	
			@Override
			public Fragment getItem(int position) {
				return mFragmentList.get(position);
			}
		};
		
		//为页面控制器设置适配器
		mViewPager.setAdapter(mPagerAdapter);
		
		//为页面控制器设置监听事件
		mViewPager.setOnPageChangeListener(new OnPageChangeListener() {		
			//切换页卡时触发
			@Override
			public void onPageSelected(int position) {
				//改变被选中页面标题的颜色
				mNavTextView1.setTextColor(Color.BLACK);
				mNavTextView2.setTextColor(Color.BLACK);
				mNavTextView3.setTextColor(Color.BLACK);
				
				switch (position) {
					case 0:
						mNavTextView1.setTextColor(Color.BLUE);
						break;
					case 1:
						mNavTextView2.setTextColor(Color.BLUE);
						frag2.updateData();
						break;
					case 2:
						mNavTextView3.setTextColor(Color.BLUE);			
						//new GetTaskThread("http://60.176.46.33:8080/Task_list",MainActivity.this).start();
						frag3.updateData();
						break;
					default:
						break;
				}
			}
			
			//滚动页面时触发
			@Override
			public void onPageScrolled(int position,float positionOffset, int positionOffsetPixels) {
	
			}
			
			//滚动状态改变时触发
			@Override
			public void onPageScrollStateChanged(int state) {
				
			}
		});

	}

}
