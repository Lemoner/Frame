/**
 * getOverDueRoomNum(int poliId)
 */

SELECT COUNT(*)
FROM 
	VIEW_DAYS_SINCE_LAST_INSPECT AS VDSLI, SYSPARAM AS SP
WHERE 
	SP.PARA_NAME = 'INSPECT_PERIOD'  AND
	VDSLI.POLI_ID = { poliId } AND 
    VDSLI.DAYS_LAST_INSPECT > SP.PARA_VALUE;


/**
 * getOverDueBuildingNum(int poliId)
 */
SELECT COUNT(*)
FROM building AS BD
WHERE BD.BUIL_ID IN (
	SELECT VDSLI.BUIL_ID
    FROM VIEW_DAYS_SINCE_LAST_INSPECT AS VDSLI, SYSPARAM AS SP
    WHERE 
		SP.PARA_NAME = 'INSPECT_PERIOD'  AND
		VDSLI.POLI_ID = 1 AND 
		VDSLI.DAYS_LAST_INSPECT > SP.PARA_VALUE
);



/**
 * getOverDueCommunityNum(int poliId)
 */
SELECT COUNT(*)
FROM community AS CM
WHERE CM.COMM_ID IN (
	SELECT VDSLI.COMM_ID
    FROM VIEW_DAYS_SINCE_LAST_INSPECT AS VDSLI, SYSPARAM AS SP
    WHERE 
		SP.PARA_NAME = 'INSPECT_PERIOD'  AND
		VDSLI.POLI_ID = 1 AND 
		VDSLI.DAYS_LAST_INSPECT > SP.PARA_VALUE
);