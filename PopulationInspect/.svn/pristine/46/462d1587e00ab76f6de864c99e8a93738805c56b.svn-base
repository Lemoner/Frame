//添加人员信息
function peopleAdd(){
	var username = $("#name").val();
	var sex = $("input[name='inlineRadioOptions']:checked").val();
	var tel = $("#tel").val();
	var idCard = $("#id-num").val();
	var logTime = $("#log-t").val();
	var logReason = $("input[name='inlineRadioOptions2']:checked").val();
	var place = $("#huji").val();
	var livePlace = $("#juzhu").val();
	var workPlace = $("#work").val();
	var object = $("input[name='inlineRadioOptions1']:checked").val();
	var copy = $("#copy").val();
	var roomId = $("#hidden").val();
	
	//isDeleted是否删除标记没写，不知道代表什么意思     persPhoto照片没有 roomId后期加入
	$.ajax({
		url:"../person/add.do",
		type:"POST",
		data:{addrLive:livePlace,addrWork:workPlace,isFocus:object,persIdcard:idCard,
			persName:username,persPhone:tel,persSex:sex,ramark:copy,timeRegister:logTime,
			whyRegister:logReason,roomId:roomId},
		dataType:"json",
		success:function(data){
			 if(data.resultCode == 1){
				 var message = $("#message");
				 message.html("");
				 message.text("恭喜您！添加成功");
				 $("#name").val("");
				 $("#tel").val("");
				 $("#id-num").val("");
				 $("#log-r").val("");
				 $("#huji").val("");
				 $("#juzhu").val("");
				 $("#work").val("");
				 $("input[name='inlineRadioOptions']").attr("checked",false);
				 $("input[name='inlineRadioOptions1']").attr("checked",false);
				 $("input[name='inlineRadioOptions2']").attr("checked",false);
				  $("#copy").val("");
			 }
		}
	});
}
//显示datetime时间格式
function showTime(roomId,roomNo){
	var logTime = $("#log-t");
	$("#roomId11").text(roomNo);
	$("#hidden").val(roomId);
	var time = new Date();
	var year = time.getFullYear();
	var month = time.getMonth()+1;
	var day = time.getDate();
	var hour = time.getHours();
	var minute = time.getMinutes();
	var second = time.getSeconds();
	logTime.val(year + "-" + month + "-" + day + " " + hour + ":" + minute + ":" + second);
	
	
}
function showTime1(policeId,roomId){
	$("#policeId").val(policeId);
	$("#roomId").val(roomId);
	var inspectId = $("#inspectId");
	var time = new Date();
	var year = time.getFullYear();
	var month = time.getMonth()+1;
	var day = time.getDate();
	var hour = time.getHours();
	var minute = time.getMinutes();
	var second = time.getSeconds();
	inspectId.val(year + "-" + month + "-" + day + " " + hour + ":" + minute + ":" + second);
	console.log(policeId,roomId);
	var statName = $('#root1 > a').html();
	var unitName = $('#root2 > a').html();
	var buildName = $('#root3 > a').html();
	var houseinfo = $("#house-info-u").text();
	var houseNo = $("#house-info-n").text();
	var inspectionMessage = $("#inspectionMessage");
	inspectionMessage.html(statName+'&nbsp;'+unitName+'&nbsp;'+buildName + '&nbsp;'+ houseinfo + '单元&nbsp;' + houseNo + '房间' );
}
//人员详情
function personInformation(personId,room){
	var roomId = $("#roomId");
	var username = $("#username");
	var sex = $("#sex");
	var tel = $("#tel");
	var idCard = $("#idCard");
	var logTime = $("#logTime");
	var logReason = $("#logReason");
	var place = $("#place");
	var livePlace = $("#livePlace");
	var workPlace = $("#workPlace");
	var isFocus = $("#isFocus");
	var copy = $("#copy");
	
	$.ajax({
		url:"../person/info",
		type:"POST",
		data:{pers_id:personId},
		dataType:"json",
		success:function(data){
			if(data.resultCode == 1){
				var person = data.person;
				console.log(person);
				console.log($("#roomId").text());
				
				$("#roomId").text(roomId.text() + room);
				$("#username").text(username.text() + person.persName);
				 console.log(person.persSex);
				if(person.persSex == true){
					$("#sex").text(sex.text() + "  男");
				}
				if(person.persSex == false){
					$("#sex").text(sex.text() + "  女");
				}
				
				$("#tel").text(tel.text() + person.persPhone);
				$("#idCard").text(idCard.text() + person.persIdcard);
			  if(person.timeRegister != null){
				  $("#logTime").text(logTime.text() + person.timeRegister);
			  }
			  
			  if(person.whyRegister == 01){
				  logReason.text(logReason.text() + "  自住");
			  }
			  console.log(person.whyRegister);
			  if(person.whyRegister == 02){
				  logReason.text(logReason.text() + "  租住");
			  }
			  if(person.whyRegister == 03){
				  logReason.text(logReason.text() + "  工作");
			  }
			 
			  place.text(place.text() + person.addrCensus);
			  livePlace.text(livePlace.text() + "  " + person.addrLive);
			  workPlace.text(workPlace.text() + "  " + person.addrWork);
			  if(person.isFocus == true){
				  isFocus.text(isFocus.text() + "是");
			  }
			  if(person.isFocus == false){
				  isFocus.text(isFocus.text() + "否");
			  }
			  copy.text(copy.text() + person.ramark);
			  
			}
			}
		});
}

//自动巡检
function autoInspection11(policeId,roomId){
	console.log(policeId,roomId);
	var autoInspectionMessage = $("#autoInspectionMessage");
	autoInspectionMessage.html("");
	$.ajax({
		url:"../inspectlog/add.do",
		type:"POST",
		data:{poli_id:policeId,room_id:roomId},
		dataType:"json",
		success:function(data){
			if(data.resultCode == 1){
				$('#autocheck-i').html("自动巡检成功！")
				// alert("巡检成功");
				
			}else{
				autoInspectionMessage.text("巡检失败，请重新操作");
			}
			},
		error:function(err){
			alert('发生了错误：'+err.status);
			console.table(err);
		}
		});
	autoInspectionMessage.text("");
}

//添加巡检日志详情
function addInspectionLog(){
	var inspectId = $("#inspectId").val();
	var subHouse = $("#houseKind").find("option:selected").val();
	var parentHouse = subHouse.substr(0,2);
	var message = $("#textarea1").val();
	var isfocus = $("input[name='isfocus']:checked").val();
	var policeId = $("#policeId").val();
	var roomId = $("#roomId").val();
	var inputInspectionMessage = $("#inputInspectionMessage");
	$.ajax({
		url:"../inspectlog/add.do",
		type:"POST",
		data:{ramark:message,poli_id:policeId,room_id:roomId,
			is_focus:isfocus},
		dataType:"json",
		success:function(data){
			
		}
	
});
	$.ajax({
	url:"../room/class/update.do",
	type:"POST",
	data:{room_id:roomId,room_class:parentHouse,room_subclass:subHouse},
	dataType:"json",
	success:function(data){
		if(data.resultCode == 1){
			inputInspectionMessage.html("");
			inputInspectionMessage.text("提交巡检记录成功");
			$("#textarea1").val("");
			$("input[name='isfocus']").attr("checked",false);
			
			
		}else{
			inputInspectionMessage.text("提交巡检记录失败");
		}
	},
	error:function(err){
		alert('发生了错误：'+err.status);
		console.table(err);
	}

});
}